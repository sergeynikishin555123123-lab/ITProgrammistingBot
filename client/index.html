<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeFarm - –£—á–∏–º Python —á–µ—Ä–µ–∑ —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–æ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ... –í–°–ï –í–ê–®–ò –°–¢–ò–õ–ò –û–°–¢–ê–Æ–¢–°–Ø –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ... */
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üöú</div>
                <div>
                    <h1>CodeFarm</h1>
                    <div style="font-size: 12px; opacity: 0.9;">–£—á–∏–º Python —á–µ—Ä–µ–∑ —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–æ</div>
                </div>
            </div>
            
            <div class="header-stats">
                <div class="stat-badge">
                    <i class="fas fa-coins"></i>
                    <span id="header-coins">100</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-star"></i>
                    <span id="header-level">–£—Ä. 1</span>
                </div>
            </div>
        </header>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="content">
            <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div id="loading-screen" class="fade-in">
                <div class="card" style="text-align: center; padding: 50px 20px;">
                    <div class="logo-icon" style="font-size: 64px; margin-bottom: 20px;">üöú</div>
                    <h2 style="color: var(--primary-dark); margin-bottom: 15px;">–ó–∞–≥—Ä—É–∂–∞–µ–º CodeFarm...</h2>
                    <p style="color: #666; margin-bottom: 30px;">–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –≤–∞—à—É —Ñ–µ—Ä–º—É –∏ —É—Ä–æ–∫–∏</p>
                    
                    <div class="progress-container" style="max-width: 400px; margin: 0 auto;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="loading-progress" style="width: 0%"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                            <span>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</span>
                            <span id="loading-percent">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Ñ–µ—Ä–º—ã -->
            <div id="main-screen" style="display: none;">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div class="section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚≠ê</div>
                            <div class="stat-value" id="user-level-value">1</div>
                            <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">ü™ô</div>
                            <div class="stat-value" id="user-coins-value">100</div>
                            <div class="stat-label">–ú–æ–Ω–µ—Ç—ã</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚ú®</div>
                            <div class="stat-value" id="user-exp-value">0</div>
                            <div class="stat-label">–û–ø—ã—Ç</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìö</div>
                            <div class="stat-value" id="user-lessons-value">0</div>
                            <div class="stat-label">–£—Ä–æ–∫–∏</div>
                        </div>
                    </div>
                </div>
     
                <!-- 2D –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–µ—Ä–º—ã -->
                <div class="section">
                    <h2 class="section-title">
                        <i class="fas fa-tractor"></i>
                        –í–∞—à–∞ 3D –§–µ—Ä–º–∞
                    </h2>
                    
                    <div id="farm-3d-container" style="
                        width: 100%; 
                        height: 500px; 
                        background: #1a1a1a;
                        border-radius: 10px;
                        overflow: hidden;
                        margin-bottom: 20px;
                        position: relative;
                    ">
                        <!-- 3D —Ñ–µ—Ä–º–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>

                    <div class="farm-stats">
                        <div class="stat-card">
                            <div class="stat-icon">üßπ</div>
                            <div>
                                <div class="stat-value" id="cleared-land-count">0</div>
                                <div class="stat-label">–û—á–∏—â–µ–Ω–æ –∑–µ–º–ª–∏</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üèóÔ∏è</div>
                            <div>
                                <div class="stat-value" id="buildings-count">0</div>
                                <div class="stat-label">–ü–æ—Å—Ç—Ä–æ–µ–∫</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üå±</div>
                            <div>
                                <div class="stat-value" id="crops-count">0</div>
                                <div class="stat-label">–†–∞—Å—Ç–µ–Ω–∏–π</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üíß</div>
                            <div>
                                <div class="stat-value" id="water-sources">0</div>
                                <div class="stat-label">–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤–æ–¥—ã</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="farm-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="farm-progress-bar" style="width: 0%"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                        <span>üåø –ó–∞—Ä–æ—Å—à–∞—è —Ñ–µ—Ä–º–∞</span>
                        <span>üèÜ –ü—Ä–æ—Ü–≤–µ—Ç–∞—é—â–∞—è —Ñ–µ—Ä–º–∞</span>
                    </div>
                </div>

                <div class="farm-controls">
                    <button class="farm-btn farm-action-btn" data-action="water">
                        <i class="fas fa-tint"></i> –ü–æ–ª–∏—Ç—å –≤—Å–µ
                    </button>
                    <button class="farm-btn farm-action-btn" data-action="harvest">
                        <i class="fas fa-shopping-basket"></i> –°–æ–±—Ä–∞—Ç—å —É—Ä–æ–∂–∞–π
                    </button>
                    <button class="farm-btn farm-action-btn" data-action="plant">
                        <i class="fas fa-seedling"></i> –ü–æ—Å–∞–¥–∏—Ç—å
                    </button>
                    <button class="farm-btn farm-action-btn" data-action="build">
                        <i class="fas fa-home"></i> –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º
                    </button>
                    <button class="farm-btn" id="toggle-view-btn" style="background: #2196F3; color: white;">
                        <i class="fas fa-cube"></i> 3D –í–∏–¥
                    </button>
                    
                    <button class="farm-btn" id="reload-farm-btn" style="background: #9C27B0; color: white;">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                    <button class="farm-btn farm-action-btn" data-action="upgrade">
                        <i class="fas fa-arrow-up"></i> –£–ª—É—á—à–∏—Ç—å
                    </button>
                </div>
                
                <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                <div class="section">
                    <h2 class="section-title">
                        <i class="fas fa-bolt"></i>
                        –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                    </h2>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button id="start-lesson-1-btn" class="btn btn-primary">
                            <i class="fas fa-code"></i> –£—Ä–æ–∫ 1: –ü–µ—Ä–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
                        </button>

                        <button id="show-lessons-btn" class="btn btn-secondary">
                            <i class="fas fa-book-open"></i> –í—Å–µ —É—Ä–æ–∫–∏
                        </button>

                        <button id="sell-produce-btn" class="btn btn-accent">
                            <i class="fas fa-shopping-cart"></i> –ü—Ä–æ–¥–∞—Ç—å —É—Ä–æ–∂–∞–π
                        </button>

                        <button id="show-code-btn" class="btn btn-primary">
                            <i class="fas fa-laptop-code"></i> –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —É—Ä–æ–∫–æ–≤ -->
            <div id="lessons-screen" style="display: none;">
                <div class="section">
                    <h2 class="section-title">
                        <i class="fas fa-graduation-cap"></i>
                        –£—Ä–æ–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
                    </h2>
                    
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div>
                                <h3 style="margin-bottom: 5px;">–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                                <p style="color: #666;">–ü—Ä–æ–π–¥–µ–Ω–æ —É—Ä–æ–∫–æ–≤: <span id="completed-lessons">0</span>/28</p>
                            </div>
                            <div class="stat-badge" style="background: var(--primary-color); color: white;">
                                <i class="fas fa-star"></i> –£—Ä–æ–≤–µ–Ω—å: <span id="user-level-text">1</span>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="lessons-progress" style="width: 0%"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                                <span>–ù–∞—á–∏–Ω–∞—é—â–∏–π</span>
                                <span>–≠–∫—Å–ø–µ—Ä—Ç</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <h2 class="section-title">
                        <i class="fas fa-code"></i>
                        –î–æ—Å—Ç—É–ø–Ω—ã–µ —É—Ä–æ–∫–∏
                    </h2>
                    
                    <div class="lessons-grid" id="lessons-list">
                        <!-- –£—Ä–æ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–æ–¥–∞ -->
            <div id="code-screen" style="display: none;">
                <!-- ... –ö–æ–¥ —ç–∫—Ä–∞–Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... -->
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
            <div id="profile-screen" style="display: none;">
                <!-- ... –ö–æ–¥ —ç–∫—Ä–∞–Ω–∞ –ø—Ä–æ—Ñ–∏–ª—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... -->
            </div>
        </div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-bar">
            <div class="nav-item active" data-screen="main">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <div class="nav-item" data-screen="lessons">
                <div class="nav-icon">üìö</div>
                <div class="nav-label">–£—Ä–æ–∫–∏</div>
            </div>
            <div class="nav-item" data-screen="code">
                <div class="nav-icon">üíª</div>
                <div class="nav-label">–ö–æ–¥</div>
            </div>
            <div class="nav-item" data-screen="profile">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
            </div>
        </nav>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
        <div class="notification-icon">‚úÖ</div>
        <div>
            <h4 style="margin: 0 0 5px 0;" id="notification-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h4>
            <p style="margin: 0; color: #666;" id="notification-message">–°–æ–æ–±—â–µ–Ω–∏–µ</p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—Ä–æ–∫–∞ -->
    <div class="modal" id="lesson-modal">
        <div class="modal-content">
            <h2 style="color: var(--primary-dark); margin-bottom: 15px;" id="modal-lesson-title">–£—Ä–æ–∫</h2>
            <div id="modal-lesson-content">
                <p>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —É—Ä–æ–∫–∞...</p>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 25px;">
                <button class="btn btn-secondary" id="close-modal-btn" style="flex: 1;">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" id="start-selected-lesson-btn" style="flex: 1;">–ù–∞—á–∞—Ç—å —É—Ä–æ–∫</button>
            </div>
        </div>
    </div>

    <!-- –¢—Ä–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
    
    <script>
        // –ü–†–û–°–¢–û–ô –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î - –±–µ–∑ spread –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ CodeFarm –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
            window.appState = {
                userId: 'user-' + Date.now(),
                userData: {
                    level: 1,
                    coins: 100,
                    experience: 0,
                    lessonsCompleted: 0,
                    completedLessonIds: []
                },
                lessons: [],
                currentLesson: null,
                farmData: {
                    cells: [],
                    size: 8,
                    stats: {
                        clearedLand: 0,
                        buildings: 0,
                        crops: 0,
                        water: 0
                    }
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —ç–∫—Ä–∞–Ω–∞
            function showScreen(screenName) {
                console.log('üñ•Ô∏è –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω: ' + screenName);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
                const screens = ['main', 'lessons', 'code', 'profile'];
                screens.forEach(screen => {
                    const element = document.getElementById(screen + '-screen');
                    if (element) {
                        element.style.display = 'none';
                    }
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
                const targetScreen = document.getElementById(screenName + '-screen');
                if (targetScreen) {
                    targetScreen.style.display = 'block';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-screen') === screenName) {
                        item.classList.add('active');
                    }
                });
                
                // –î–ª—è —ç–∫—Ä–∞–Ω–∞ —É—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤
                if (screenName === 'lessons' && window.appState.lessons.length > 0) {
                    renderLessons();
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–æ–≤
            async function loadLessons() {
                console.log('üìö –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Ä–æ–∫–∏...');
                try {
                    // –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ —É—Ä–æ–∫–∏
                    window.appState.lessons = [
                        {
                            id: 'lesson_1',
                            title: '–ü–µ—Ä–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã - –†–∞—Å—á–∏—Å—Ç–∫–∞ —Ñ–µ—Ä–º—ã',
                            description: '–ù–∞—É—á–∏—Ç–µ—Å—å –¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç—É –¥–ª—è —Ä–∞—Å—á–∏—Å—Ç–∫–∏ –≤—Å–µ–π —Ñ–µ—Ä–º—ã',
                            level: 1,
                            rewardCoins: 100,
                            rewardExp: 200,
                            theory: '–í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ print() –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –±–æ—Ç–æ–º –∏ clear_area() –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–µ—Ä–º–æ–π.',
                            task: '–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –±–æ—Ç–∞ –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç –µ–≥–æ —Ä–∞—Å—á–∏—Å—Ç–∏—Ç—å –≤—Å—é —Ñ–µ—Ä–º—É –æ—Ç —Ç—Ä–∞–≤—ã.',
                            testCode: 'print("–ü—Ä–∏–≤–µ—Ç, —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏–π –±–æ—Ç!")\nprint("–ù–∞—á–∏–Ω–∞—é —Ä–∞—Å—á–∏—Å—Ç–∫—É —Ñ–µ—Ä–º—ã")\nclear_area("–≤—Å—è —Ñ–µ—Ä–º–∞")\nprint("–§–µ—Ä–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å—á–∏—â–µ–Ω–∞!")',
                            initialCode: '# –£—Ä–æ–∫ 1: –†–∞—Å—á–∏—Å—Ç–∫–∞ —Ñ–µ—Ä–º—ã\n# –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ –¥–ª—è —Ä–∞—Å—á–∏—Å—Ç–∫–∏ –≤—Å–µ–π —Ñ–µ—Ä–º—ã\n\n# 1. –ü–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–π—Ç–µ –±–æ—Ç–∞\n\n# 2. –†–∞—Å—á–∏—Å—Ç–∏—Ç–µ —Ñ–µ—Ä–º—É\n\n# 3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ'
                        },
                        {
                            id: 'lesson_2',
                            title: '–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–∞',
                            description: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –¥–æ–º–∞ –Ω–∞ —Ñ–µ—Ä–º–µ',
                            level: 1,
                            rewardCoins: 150,
                            rewardExp: 300,
                            theory: '–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç –¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞–∫ = –¥–ª—è –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è.',
                            task: '–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–æ–º–∞ –∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º –≤ —Ü–µ–Ω—Ç—Ä–µ —Ñ–µ—Ä–º—ã.',
                            testCode: '# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –¥–æ–º–∞\nx = 3\ny = 3\n\n# –°—Ç—Ä–æ–∏–º –¥–æ–º\nbuild_house(x, y)\n\nprint(f"–î–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: x={x}, y={y}")',
                            initialCode: '# –£—Ä–æ–∫ 2: –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–∞\n# –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º –≤ —Ü–µ–Ω—Ç—Ä–µ —Ñ–µ—Ä–º—ã\n\n# 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—Ü–µ–Ω—Ç—Ä —Ñ–µ—Ä–º—ã 8x8)\n\n# 2. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º\n\n# 3. –í—ã–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏'
                        }
                    ];
                    
                    console.log('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ' + window.appState.lessons.length + ' —É—Ä–æ–∫–æ–≤');
                    renderLessons();
                    return window.appState.lessons;
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–æ–≤:', error);
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–º–æ —É—Ä–æ–∫–∏
                    window.appState.lessons = [
                        {
                            id: 'lesson_1',
                            title: '–î–µ–º–æ —É—Ä–æ–∫',
                            description: '–ë–∞–∑–æ–≤—ã–π —É—Ä–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è',
                            level: 1,
                            rewardCoins: 100,
                            rewardExp: 200
                        }
                    ];
                    renderLessons();
                    return window.appState.lessons;
                }
            }
            
            // –†–µ–Ω–¥–µ—Ä —É—Ä–æ–∫–æ–≤
            function renderLessons() {
                const container = document.getElementById('lessons-list');
                if (!container) return;
                
                container.innerHTML = '';
                
                window.appState.lessons.forEach((lesson, index) => {
                    const card = document.createElement('div');
                    card.className = 'lesson-card';
                    card.innerHTML = `
                        <div class="lesson-header">
                            <div class="lesson-number">${index + 1}</div>
                            <div class="lesson-status status-in-progress"></div>
                        </div>
                        <h3 style="margin-bottom: 10px;">${lesson.title}</h3>
                        <p style="color: #666; margin-bottom: 15px;">${lesson.description}</p>
                        
                        <div class="lesson-rewards">
                            <div class="reward-item">
                                <i class="fas fa-coins"></i>
                                <span>${lesson.rewardCoins} –º–æ–Ω–µ—Ç</span>
                            </div>
                            <div class="reward-item">
                                <i class="fas fa-star"></i>
                                <span>${lesson.rewardExp} –æ–ø—ã—Ç–∞</span>
                            </div>
                            <div class="reward-item">
                                <i class="fas fa-layer-group"></i>
                                <span>–£—Ä–æ–≤–µ–Ω—å ${lesson.level}</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" 
                                onclick="window.startLesson('${lesson.id}')">
                            –ù–∞—á–∞—Ç—å —É—Ä–æ–∫
                        </button>
                    `;
                    container.appendChild(card);
                });
            }
            
            // –°—Ç–∞—Ä—Ç —É—Ä–æ–∫–∞
            window.startLesson = function(lessonId) {
                console.log('üéØ –ù–∞—á–∏–Ω–∞–µ–º —É—Ä–æ–∫: ' + lessonId);
                
                const lesson = window.appState.lessons.find(function(l) {
                    return l.id === lessonId;
                });
                
                if (!lesson) {
                    showNotification('‚ùå –û—à–∏–±–∫–∞', '–£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return;
                }
                
                window.appState.currentLesson = lesson;
                showScreen('code');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É—Ä–æ–∫–∞
                setTimeout(function() {
                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                    const titleEl = document.getElementById('current-lesson-title');
                    if (titleEl) {
                        titleEl.textContent = lesson.title;
                    }
                    
                    // –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
                    const editor = document.getElementById('code-editor');
                    if (editor) {
                        editor.value = lesson.initialCode || '# –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ –∑–¥–µ—Å—å';
                        editor.style.height = 'auto';
                        editor.style.height = (editor.scrollHeight) + 'px';
                    }
                    
                    console.log('‚úÖ –£—Ä–æ–∫ "' + lesson.title + '" –Ω–∞—á–∞—Ç');
                }, 100);
            };
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–µ—Ä–º—ã
            function createInitialFarm() {
                console.log('üåæ –°–æ–∑–¥–∞–µ–º —Ñ–µ—Ä–º—É...');
                const grid = document.getElementById('farm-grid');
                if (!grid) return;
                
                grid.innerHTML = '';
                window.appState.farmData.cells = [];
                
                // –°–æ–∑–¥–∞–µ–º —Å–µ—Ç–∫—É 8x8
                for (let row = 0; row < 8; row++) {
                    for (let col = 0; col < 8; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'farm-cell grass';
                        cell.dataset.row = row;
                        cell.dataset.col = col;
                        
                        cell.innerHTML = `
                            <div class="farm-cell-icon">üåø</div>
                            <div class="farm-cell-label">${row},${col}</div>
                        `;
                        
                        cell.title = '–ó–∞—Ä–æ—Å—à–∏–π —É—á–∞—Å—Ç–æ–∫. –ü—Ä–æ–π–¥–∏—Ç–µ –£—Ä–æ–∫ 1, —á—Ç–æ–±—ã —Ä–∞—Å—á–∏—Å—Ç–∏—Ç—å –∑–µ–º–ª—é!';
                        
                        cell.addEventListener('click', function() {
                            handleFarmClick(row, col, 'grass');
                        });
                        
                        grid.appendChild(cell);
                        
                        window.appState.farmData.cells.push({
                            row: row,
                            col: col,
                            type: 'grass',
                            icon: 'üåø',
                            title: '–ó–∞—Ä–æ—Å—à–∏–π —É—á–∞—Å—Ç–æ–∫'
                        });
                    }
                }
                
                updateFarmStats();
            }
            
            function handleFarmClick(row, col, type) {
                let message = '';
                switch(type) {
                    case 'grass':
                        message = 'üåø –ó–∞—Ä–æ—Å—à–∏–π —É—á–∞—Å—Ç–æ–∫. –ü—Ä–æ–π–¥–∏—Ç–µ –£—Ä–æ–∫ 1, —á—Ç–æ–±—ã —Ä–∞—Å—á–∏—Å—Ç–∏—Ç—å –∑–µ–º–ª—é!';
                        break;
                    case 'cleared':
                        message = 'üü´ –†–∞—Å—á–∏—â–µ–Ω–Ω–∞—è –∑–µ–º–ª—è. –ì–æ—Ç–æ–≤–∞ –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –∏–ª–∏ –ø–æ—Å–∞–¥–∫–∏.';
                        break;
                    case 'house':
                        message = 'üè† –î–æ–º —Ñ–µ—Ä–º–µ—Ä–∞. –ì–ª–∞–≤–Ω–æ–µ –∑–¥–∞–Ω–∏–µ –≤–∞—à–µ–π —Ñ–µ—Ä–º—ã.';
                        break;
                    case 'crop':
                        message = 'üåæ –ü–æ—Å–∞–¥–∫–∏. –†–∞—Å—Ç–µ–Ω–∏—è —Ä–∞—Å—Ç—É—Ç! –°–∫–æ—Ä–æ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–±—Ä–∞—Ç—å —É—Ä–æ–∂–∞–π.';
                        break;
                }
                
                showNotification('üìç –§–µ—Ä–º–∞', message);
            }
            
            function updateFarmStats() {
                if (!window.appState.farmData.cells) return;
                
                const stats = {
                    cleared: window.appState.farmData.cells.filter(function(c) {
                        return c.type !== 'grass';
                    }).length,
                    buildings: window.appState.farmData.cells.filter(function(c) {
                        return c.type === 'house' || c.type === 'barn';
                    }).length,
                    crops: window.appState.farmData.cells.filter(function(c) {
                        return c.type === 'crop';
                    }).length,
                    water: window.appState.farmData.cells.filter(function(c) {
                        return c.type === 'water';
                    }).length
                };
                
                // –û–±–Ω–æ–≤–ª—è–µ–º DOM
                document.getElementById('cleared-land-count').textContent = stats.cleared;
                document.getElementById('buildings-count').textContent = stats.buildings;
                document.getElementById('crops-count').textContent = stats.crops;
                document.getElementById('water-sources').textContent = stats.water;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
                const progressBar = document.getElementById('farm-progress-bar');
                if (progressBar) {
                    const progress = (stats.cleared / 64) * 100;
                    progressBar.style.width = progress + '%';
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                window.appState.farmData.stats = stats;
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Ñ–µ—Ä–º–µ –ø–æ—Å–ª–µ —É—Ä–æ–∫–∞
            function applyFarmChanges(lessonId) {
                console.log('üåæ –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —É—Ä–æ–∫–∞: ' + lessonId);
                
                let cellsToUpdate = [];
                let message = '';
                let emoji = '‚ú®';
                
                switch(lessonId) {
                    case 'lesson_1':
                        // –†–∞—Å—á–∏—Å—Ç–∫–∞ –≤—Å–µ–π —Ñ–µ—Ä–º—ã
                        emoji = 'üßπ';
                        message = '–§–µ—Ä–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å—á–∏—â–µ–Ω–∞ –æ—Ç —Ç—Ä–∞–≤—ã!';
                        
                        cellsToUpdate = window.appState.farmData.cells.filter(function(cell) {
                            return cell.type === 'grass';
                        });
                        
                        cellsToUpdate.forEach(function(cell) {
                            cell.type = 'cleared';
                            cell.icon = 'üü´';
                            cell.title = '–†–∞—Å—á–∏—â–µ–Ω–Ω–∞—è –∑–µ–º–ª—è';
                        });
                        break;
                        
                    case 'lesson_2':
                        // –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ
                        emoji = 'üè†';
                        message = '–î–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω –≤ —Ü–µ–Ω—Ç—Ä–µ —Ñ–µ—Ä–º—ã!';
                        
                        const centerCells = window.appState.farmData.cells.filter(function(cell) {
                            return cell.row >= 3 && cell.row <= 4 && 
                                   cell.col >= 3 && cell.col <= 4;
                        }).slice(0, 4); // 2x2 –¥–æ–º
                        
                        cellsToUpdate = centerCells;
                        centerCells.forEach(function(cell) {
                            cell.type = 'house';
                            cell.icon = 'üè†';
                            cell.title = '–î–æ–º —Ñ–µ—Ä–º–µ—Ä–∞';
                        });
                        break;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º DOM —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
                cellsToUpdate.forEach(function(cell, index) {
                    setTimeout(function() {
                        const cellElement = document.querySelector(
                            '.farm-cell[data-row="' + cell.row + '"][data-col="' + cell.col + '"]'
                        );
                        if (cellElement) {
                            cellElement.className = 'farm-cell ' + cell.type;
                            cellElement.innerHTML = `
                                <div class="farm-cell-icon">${cell.icon}</div>
                                <div class="farm-cell-label">${cell.row},${cell.col}</div>
                            `;
                            cellElement.classList.add('grow-animation');
                            
                            setTimeout(function() {
                                cellElement.classList.remove('grow-animation');
                            }, 500);
                        }
                    }, index * 50);
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateFarmStats();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                if (message) {
                    showNotification(emoji, message);
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            function updateUserStats() {
                // –ó–∞–≥–æ–ª–æ–≤–æ–∫
                document.getElementById('user-level-value').textContent = window.appState.userData.level;
                document.getElementById('user-coins-value').textContent = window.appState.userData.coins;
                document.getElementById('user-exp-value').textContent = window.appState.userData.experience;
                document.getElementById('user-lessons-value').textContent = window.appState.userData.lessonsCompleted;
                
                // –®–∞–ø–∫–∞
                document.getElementById('header-coins').textContent = window.appState.userData.coins;
                document.getElementById('header-level').textContent = '–£—Ä. ' + window.appState.userData.level;
                
                // –≠–∫—Ä–∞–Ω —É—Ä–æ–∫–æ–≤
                document.getElementById('completed-lessons').textContent = window.appState.userData.lessonsCompleted;
                document.getElementById('user-level-text').textContent = window.appState.userData.level;
                
                // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —É—Ä–æ–∫–æ–≤
                const progressBar = document.getElementById('lessons-progress');
                if (progressBar && window.appState.lessons.length > 0) {
                    const progress = (window.appState.userData.lessonsCompleted / window.appState.lessons.length) * 100;
                    progressBar.style.width = Math.min(100, progress) + '%';
                }
            }
            
            // –ó–∞–ø—É—Å–∫ –∫–æ–¥–∞
            window.runCode = function() {
                const code = document.getElementById('code-editor') ? document.getElementById('code-editor').value : '';
                const output = document.getElementById('output-text');
                
                if (!code || !output) return;
                
                output.textContent = 'üöÄ –í—ã–ø–æ–ª–Ω—è—é –∫–æ–¥...\n\n';
                document.getElementById('output-container').style.display = 'block';
                
                // –ò–º–∏—Ç–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                setTimeout(function() {
                    const lines = code.split('\n');
                    let result = '';
                    
                    lines.forEach(function(line) {
                        if (line.includes('print(')) {
                            const match = line.match(/print\(["'](.+?)["']\)/);
                            if (match) {
                                result += '>>> ' + match[1] + '\n';
                            }
                        }
                    });
                    
                    output.textContent += result + '\n‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
                }, 500);
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è
            window.submitSolution = async function() {
                const code = document.getElementById('code-editor') ? document.getElementById('code-editor').value : '';
                
                if (!code || !window.appState.currentLesson) {
                    showNotification('‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ', '–°–Ω–∞—á–∞–ª–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥');
                    return;
                }
                
                showNotification('‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞', '–ü—Ä–æ–≤–µ—Ä—è—é –≤–∞—à –∫–æ–¥...');
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥
                    const checkResult = checkCode(code, window.appState.currentLesson.id);
                    
                    if (checkResult.success) {
                        // –£—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω
                        await completeLesson(window.appState.currentLesson.id, code);
                    } else {
                        showNotification('‚ùå –û—à–∏–±–∫–∞', checkResult.message);
                    }
                } catch (error) {
                    showNotification('‚ùå –û—à–∏–±–∫–∞', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–¥–∞');
                }
            };
            
            function checkCode(code, lessonId) {
                const cleanCode = code.toLowerCase().replace(/\s+/g, ' ');
                
                switch(lessonId) {
                    case 'lesson_1':
                        const hasPrint = code.includes('print');
                        const hasClear = cleanCode.includes('clear_area');
                        return {
                            success: hasPrint && hasClear,
                            message: hasPrint && hasClear ? '–ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!' : '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ print() –∏ clear_area()'
                        };
                        
                    case 'lesson_2':
                        const hasVariable = (cleanCode.includes('x=') || cleanCode.includes('x =')) && 
                                          (cleanCode.includes('y=') || cleanCode.includes('y ='));
                        const hasBuild = cleanCode.includes('build_house');
                        return {
                            success: hasVariable && hasBuild,
                            message: hasVariable && hasBuild ? '–ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!' : '–ù—É–∂–Ω–æ: x=3, y=3 –∏ build_house(x, y)'
                        };
                        
                    default:
                        return {
                            success: code.length > 10,
                            message: code.length > 10 ? '–ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!' : '–ö–æ–¥ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π'
                        };
                }
            }
            
            async function completeLesson(lessonId, code) {
                const lesson = window.appState.lessons.find(function(l) {
                    return l.id === lessonId;
                });
                if (!lesson) return;
                
                // –ù–∞–≥—Ä–∞–¥–∞
                const rewardCoins = lesson.rewardCoins || 100;
                const rewardExp = lesson.rewardExp || 200;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (!window.appState.userData.completedLessonIds.includes(lessonId)) {
                    window.appState.userData.coins += rewardCoins;
                    window.appState.userData.experience += rewardExp;
                    window.appState.userData.lessonsCompleted += 1;
                    window.appState.userData.completedLessonIds.push(lessonId);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
                    const newLevel = Math.max(1, Math.floor(window.appState.userData.experience / 1000) + 1);
                    if (newLevel > window.appState.userData.level) {
                        window.appState.userData.level = newLevel;
                        showNotification('‚≠ê –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å!', '–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω—è ' + newLevel + '!');
                    }
                }
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Ñ–µ—Ä–º–µ
                applyFarmChanges(lessonId);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateUserStats();
                renderLessons();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification('üéâ –£—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω!', 
                    lesson.title + ' –ø—Ä–æ–π–¥–µ–Ω!\n–ù–∞–≥—Ä–∞–¥–∞: ' + rewardCoins + ' –º–æ–Ω–µ—Ç\n–û–ø—ã—Ç: +' + rewardExp);
            }
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            function showNotification(title, message) {
                const notification = document.getElementById('notification');
                if (!notification) return;
                
                notification.querySelector('#notification-title').textContent = title;
                notification.querySelector('#notification-message').textContent = message;
                
                notification.classList.remove('show');
                void notification.offsetWidth;
                notification.classList.add('show');
                
                setTimeout(function() {
                    notification.classList.remove('show');
                }, 4000);
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            function initEventHandlers() {
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                document.querySelectorAll('.nav-item').forEach(function(item) {
                    item.addEventListener('click', function() {
                        const screen = this.getAttribute('data-screen');
                        if (screen) showScreen(screen);
                    });
                });
                
                // –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                document.getElementById('start-lesson-1-btn')?.addEventListener('click', function() {
                    window.startLesson('lesson_1');
                });
                
                document.getElementById('show-lessons-btn')?.addEventListener('click', function() {
                    showScreen('lessons');
                });
                
                document.getElementById('show-code-btn')?.addEventListener('click', function() {
                    showScreen('code');
                });
                
                // –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
                document.getElementById('run-code-btn')?.addEventListener('click', function() {
                    window.runCode();
                });
                
                document.getElementById('submit-code-btn')?.addEventListener('click', function() {
                    window.submitSolution();
                });
                
                document.getElementById('clear-output-btn')?.addEventListener('click', function() {
                    document.getElementById('output-text').textContent = '';
                });
                
                document.getElementById('reset-code-btn')?.addEventListener('click', function() {
                    if (window.appState.currentLesson) {
                        const editor = document.getElementById('code-editor');
                        if (editor) {
                            editor.value = window.appState.currentLesson.initialCode;
                            editor.style.height = 'auto';
                            editor.style.height = (editor.scrollHeight) + 'px';
                        }
                    }
                });
                
                // –ê–≤—Ç–æ–ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
                const editor = document.getElementById('code-editor');
                if (editor) {
                    editor.addEventListener('input', function() {
                        this.style.height = 'auto';
                        this.style.height = (this.scrollHeight) + 'px';
                    });
                }
                
                // –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Ñ–µ—Ä–º–µ
                document.querySelectorAll('.farm-action-btn').forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        const action = this.getAttribute('data-action');
                        handleFarmAction(action);
                    });
                });
            }
            
            function handleFarmAction(action) {
                switch(action) {
                    case 'water':
                        showNotification('üíß –ü–æ–ª–∏–≤', '–ü–æ–ª–∏–≤–∞–µ–º —Ä–∞—Å—Ç–µ–Ω–∏—è...');
                        break;
                    case 'harvest':
                        showNotification('üì¶ –°–±–æ—Ä —É—Ä–æ–∂–∞—è', '–°–æ–±–∏—Ä–∞–µ–º —É—Ä–æ–∂–∞–π...');
                        break;
                    case 'plant':
                        showNotification('üå± –ü–æ—Å–∞–¥–∫–∞', '–°–∞–∂–∞–µ–º –Ω–æ–≤—ã–µ —Ä–∞—Å—Ç–µ–Ω–∏—è...');
                        break;
                }
            }
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            async function init() {
                console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                document.getElementById('loading-screen').style.display = 'none';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Ä–æ–∫–∏
                await loadLessons();
                
                // –°–æ–∑–¥–∞–µ–º —Ñ–µ—Ä–º—É
                createInitialFarm();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                initEventHandlers();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateUserStats();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
                showScreen('main');
                
                console.log('‚úÖ CodeFarm –∑–∞–ø—É—â–µ–Ω!');
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
            await init();
        });
    </script>
</body>
</html>
